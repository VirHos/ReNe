# Рекомендательная система новостей для пользователей mos.ru и приложения «Моя Москва»

## Команда PyPyPy

### Данные
Из новостей извлекаются признаки:  
- Тэги  
- Район, округ
- Название текста
- Превью новости

Модели и процесс получения рекомендаций

Создание базы поиска лучших рекомендованных новостей:
Для каждой новости высчитываются ее мета характеристики и конкатенируются в строку
Индексация полученных векторов через Faiss для быстрого поиска ближайших соседей новостей с метрикой Metric_inner_product 

Подбор лучших рекомендаций пользователю:  
Выбираются 8 последних прочитанных новостей и высчитывается средний вектор между ними
Производится через Faiss поиск ближайших к данному вектору 32 лучших новостей
Отфильтровываются прочитанные новости
Ранжируются новости по дате. В будущем возможно делать ранжирование с помощью более продвинутых алгоритмов для повышения CTR.

Обоснование решения  
Практика показывает, что контекстный подход(item-based) к рекомендациям даёт лучший результат чем таргетирование по сегментам пользователей или по похожим пользователям(user-based).

Так же такое решение позволяет быстро обновлять рекомендации пользователю в соответствии с его последними просмотренными статьями.  

Имея предрасчитанные единожды векторы новостей, достаточно добавить вектор в историю пользователю и не нужно его пересчитывать. 

Затем для рекомендации пользователю идет быстрая операция высчитывания среднего между последними новостями, которые он прочитал и поиск наилучших для него рекомендаций без пересчета какими-то сложными моделями.


Код и использованный стэк  
https://github.com/ibragim-bad/ReNe

transformers==4.4.0
python==3.6  
tensorflow==1.15  
pyyaml==5.1.2  
streamlit==0.82.0   
faiss-cpu==1.7.1.post2  
flask==1.0.2  
tqdm  
xlrd==1.1.0  

### Демо

Для демонстрации работы сервиса используется streamlit
http://62.84.115.137:8501/
Можно выбрать конкретного пользователя и получить ответ в виде рекомендованного списка новостей.

Submission

Код генерации решения задачи (.csv)
https://colab.research.google.com/drive/1cd3tzmFy2F9V8blZ-P168PzyYc9n1kpG?usp=sharing
